/*! simpleWebDevTool 25-07-2014 */"use strict";var controller={},simpleWebDevTool={};simpleWebDevTool.controller={},simpleWebDevTool.views={},simpleWebDevTool.service={},simpleWebDevTool.dao={},simpleWebDevTool.util={},simpleWebDevTool.cache={},simpleWebDevTool.component={},console.logBlack=function(a){console.log("%c"+a,"color:#fff;background:#000;")},jQuery(function(){var a=Sammy("#SimpleWebDevTool",function(a){a.get("#/path",function(){$("#template").html(_.template(simpleWebDevTool.util.render("template1"))),controller=simpleWebDevTool.controller.pathController(),controller.init()}),a.get("#/path2",function(){$("#template").html(_.template(simpleWebDevTool.util.render("template2"))),controller=simpleWebDevTool.controller.path2Controller(),controller.init()}),a.get("#/vue",function(){console.log("access to #/vue"),$("#template").html(_.template(simpleWebDevTool.util.render("vueTemplate"))),controller=simpleWebDevTool.controller.vueController(),controller.load()}),a.get("#/jquery",function(){console.log("access to #/jquery"),$("#template").html(_.template(simpleWebDevTool.util.render("jqueryTemplate"))),controller=simpleWebDevTool.controller.jqueryController(),controller.load()}),a.get("#/path2/:id",function(a){console.log(a.params.id)})});a.run()}),simpleWebDevTool.component.basicSelector=function(a){var b={},c={};return b.refresh=function(b){!_.isEqual(c,b)&&b&&(c=_.cloneDeep(b),$(a).select2({data:b}))},b.getSelectedData=function(){return $(a).select2("data")},b},simpleWebDevTool.component.jstree=function(a){var b={},c={},d=$(a);return b.search=function(a){d.jstree(!0).search(a)},b.getSelectNode=function(){return d.jstree(!0).get_selected()},b.demoCreate=function(){var a=d.jstree(!0),b=a.get_selected();return b.length?(b=b[0],b=a.create_node(b,{type:"file"}),void(b&&a.edit(b))):!1},b.demoRename=function(){var a=d.jstree(!0),b=a.get_selected();return b.length?(b=b[0],void a.edit(b)):!1},b.demoDelete=function(){var a=d.jstree(!0),b=a.get_selected();return b.length?void a.delete_node(b):!1},b.refresh=function(a){!_.isEqual(a,c)&&a&&(console.log("jstree refresh"),c=_.cloneDeep(a),d.jstree({core:{animation:0,check_callback:!0,themes:{stripes:!0},data:[{id:"node_1",text:"Root node",children:[{id:"node_1_1",text:"Child 1"},{id:"node_1_2",text:"Child 2"}]},{id:"node_2",text:"Root node with options",state:{opened:!0,selected:!0},children:[{id:"node_2_1",text:"Child A"},{id:"node_2_2",text:"Child B"}]}]},types:{"#":{max_children:1,max_depth:4,valid_children:["root"]},root:{icon:"/static/3.0.2/assets/images/tree_icon.png",valid_children:["default"]},"default":{valid_children:["default","file"]},file:{icon:"glyphicon glyphicon-file",valid_children:!0}},plugins:["contextmenu","dnd","search","state","types","wholerow"]}))},b},simpleWebDevTool.component.multiSelector=function(a){var b={},c={};return b.refresh=function(b){!_.isEqual(c,b)&&b&&(c=_.cloneDeep(b),$(a).select2({data:b,multiple:!0}))},b.getSelectedData=function(){return $(a).select2("data")},b},simpleWebDevTool.component.sampleBox=function(a){var b=$(a),c={},d={};return c.refresh=function(a){!_.isEqual(d,a)&&a&&(d=_.cloneDeep(a),b.empty(),_.forEach(a,function(a){var c=a+"_box";b.append(_.template(simpleWebDevTool.util.render("template_partial"),{_id:c})),simpleWebDevTool.component.tinyMce("#"+c)}))},c.getValue=function(){return b.val()},c},simpleWebDevTool.component.sampleFloat=function(a){$(a).portamento()},simpleWebDevTool.component.sampleForm=function(a){var b={},c=$(a);return b.refresh=function(a){c.val(a)},b.getValue=function(){return c.val()},b},simpleWebDevTool.component.sampleList=function(a){var b=$(a),c={},d={};return c.refresh=function(c){!_.isEqual(d,c)&&c&&(d=_.cloneDeep(c),b.empty(),_.forEach(c,function(a){b.append("<li>"+a+"</li>")}),$(a+" li").on("click",function(){var b=$(a+" li").index(this)+1;controller.listEvent(a,b)}))},c.getList=function(){return $(a+" li").map(function(){return Number(this.innerHTML)}).get()},c},simpleWebDevTool.component.slickGrid=function(a){function b(a,b){return a.percentComplete>=b}{var c=[{id:"sel",name:"#",field:"num",behavior:"select",cssClass:"cell-selection",width:40,resizable:!1,selectable:!1,sortable:!0},{id:"title",name:"Title",field:"title",width:120,minWidth:120,cssClass:"cell-title"},{id:"duration",name:"Duration",field:"duration"},{id:"%",name:"% Complete",field:"percentComplete",width:80,resizable:!1,formatter:Slick.Formatters.PercentCompleteBar},{id:"start",name:"Start",field:"start",minWidth:60},{id:"finish",name:"Finish",field:"finish",minWidth:60},{id:"effort-driven",name:"Effort Driven",width:80,minWidth:20,maxWidth:80,cssClass:"cell-effort-driven",field:"effortDriven",formatter:Slick.Formatters.Checkmark}],d={editable:!1,enableAddRow:!1,enableCellNavigation:!0},e=0,f=new Slick.Data.DataView({inlineFilters:!0}),g=new Slick.Grid(a,f,c,d);new Slick.Controls.Pager(f,g,$("#pager"))}f.onRowCountChanged.subscribe(function(){g.updateRowCount(),g.render()}),f.onRowsChanged.subscribe(function(a,b){g.invalidateRows(b.rows),g.render()});var h,i={};return i.refresh=function(a){!_.isEqual(h,a)&&a&&(h=_.cloneDeep(a),f.beginUpdate(),f.setItems(h),f.setFilter(b),f.setFilterArgs(0),f.endUpdate())},i.filterAndUpdate=function(a){var b=a>e,c=e>a,d=g.getRenderedRange();f.setFilterArgs(a),f.setRefreshHints({ignoreDiffsBefore:d.top,ignoreDiffsAfter:d.bottom+1,isFilterNarrowing:b,isFilterExpanding:c}),f.refresh(),e=a},i},simpleWebDevTool.component.tinyMce=function(a){var b,c=$(a);return{getHtml:function(){return c.html()},refresh:function(d){!_.isEqual(b,d)&&d&&(tinymce.init({selector:a,inline:!0,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste"],toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image",image_list:d.image_list}),c.html(d.main_text))}}},simpleWebDevTool.component.tinyMceTitle=function(a){var b;return{getValue:function(){return $(a).val()},refresh:function(c){!_.isEqual(b,c)&&c&&(tinymce.init({selector:a,inline:!0,toolbar:"undo redo",menubar:!1}),$(a).val(c.main_text))}}},simpleWebDevTool.controller.jqueryController=function(){var a="jqueryController",b=simpleWebDevTool.service.mainService,c=simpleWebDevTool.component.jstree("#jstree_demo"),d=simpleWebDevTool.component.slickGrid("#myGrid"),e=simpleWebDevTool.component.tinyMce("#editable"),f=simpleWebDevTool.component.tinyMceTitle("#editable_title"),g=simpleWebDevTool.component.sampleForm("#sampleForm"),h=simpleWebDevTool.component.sampleForm("#demo_q"),i=$("#text"),j=simpleWebDevTool.component.sampleList("#list"),k=simpleWebDevTool.component.sampleList("#list2"),l=simpleWebDevTool.component.basicSelector("#basicselect"),m=simpleWebDevTool.component.multiSelector("#e9"),n=simpleWebDevTool.component.sampleBox("#box"),o=(simpleWebDevTool.component.sampleFloat("#float_"),{});return o.load=function(){console.logBlack("init "+a),b.load()},o.add=function(){console.logBlack("func1 "+a);var c=g.getValue(),d=j.getList();d=b.add(d,c),controller.refresh({listData:d}),console.log("func1 done")},o.search=function(){console.logBlack("search "+a);var c=b.search(j.getList(),g.getValue());controller.refresh({listData:c}),console.log("search done"),d.filterAndUpdate(Number(g.getValue()))},o.addElem=function(){console.logBlack("search "+a);var c=b.addElem(j.getList(),g.getValue());controller.refresh({listData:c}),console.log("search done")},o.refer=function(){var a=e.getHtml(),c=b.refer(a);controller.refresh({textData:c})},o.refresh=function(a){console.logBlack("refresh");var b=_.cloneDeep(a);j.refresh(b.listData),k.refresh(b.listData),c.refresh(b.jsData),d.refresh(b.slickData),l.refresh(b.select2Data),m.refresh(b.select2Data),n.refresh(b.listData),e.refresh(b.tinyMceData),f.refresh(b.tinyMceData),b.textData&&i.text(b.textData)},o.refreshBacon=function(a){console.logBlack("refresh"),j.refresh(a.list),k.refresh(a.list),c.refresh(a.jsTree),d.refresh(a.slickGrid),l.refresh(a.select2),m.refresh(a.select2),e.refresh(a.tinyMce),f.refresh(a.tinyMce)},o.demoCreate=function(){c.demoCreate()},o.demoDelete=function(){c.demoDelete()},o.demoRename=function(){c.demoRename()},o.jstreeSearch=function(){c.search(h.getValue())},o.jstreeRefToForm=function(){var a=c.getSelectNode();h.refresh(a)},o.listEvent=function(a,b){console.log(a+b)},o.getSelectedData=function(){var a=l.getSelectedData();controller.refresh({textData:JSON.stringify(a)})},o.getSelectedDataMulti=function(){var a=m.getSelectedData();controller.refresh({textData:JSON.stringify(a)})},o},simpleWebDevTool.controller.path2Controller=function(){var a="path2Controller",b=simpleWebDevTool.service.path2Service();return{func1:function(){console.log("func1 "+a),b.func1(),console.log("func1 done")},func2:function(){console.log("func2 "+a),b.func2(),console.log("func2 done")},func3:function(){var c=[1,3];console.log("func3 "+a),b.save(c),console.log("func3 done")},init:function(){console.log("init "+a),b.load(),console.log("init done")},refresh:function(){console.log("refresh "+a);var c=b.getData();$("#list").empty(),_.forEach(c.data,function(a){$("#list").append("<li>"+a+"</li>")}),$("#text").text(c.refHtml)}}},simpleWebDevTool.controller.pathController=function(){var a="pathController",b=simpleWebDevTool.service.pathService();return tinymce.init({selector:"h1.editable",inline:!0,toolbar:"undo redo",menubar:!1}),tinymce.init({selector:"div.editable",inline:!0,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste"],toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"}),$("div.editable").keyup(function(){controller.refer()}),{add:function(){console.log("func1 "+a);var c=$("#sampleForm").val();b.add(c),controller.refresh(),console.log("func1 done")},search:function(){console.log("search "+a);var c=$("#sampleForm").val();b.search(c),controller.refresh(),console.log("search done")},init:function(){console.log("init "+a),b.load()},refer:function(){var a=$("div.editable").html();b.refer(a),controller.refresh()},refresh:function(){var a=b.getData();$("#list").empty(),_.forEach(a.data,function(a){$("#list").append("<li>"+a+"</li>")}),$("#text").text(a.refHtml)}}},simpleWebDevTool.controller.vueController=function(){var a="vueController",b=simpleWebDevTool.service.mainService,c=new Vue({el:"#template",data:{texts:["# hello"],list:[],form_:""}});tinymce.init({selector:"h1.editable",inline:!0,toolbar:"undo redo",menubar:!1}),tinymce.init({selector:"div.editable",inline:!0,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste"],toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"}),$("div.editable").keyup(function(){controller.refer()});var d={};return d.add=function(){console.log("func1 "+a);var d=$("#sampleForm").val(),e=b.add(c.list,d);controller.refresh({listData:e}),console.log("func1 done")},d.search=function(){console.log("search "+a);var d=$("#sampleForm").val(),e=b.search(c.list,d);controller.refresh({listData:e}),console.log("search done")},d.addElem=function(){console.log("search "+a);var d=$("#sampleForm").val(),e=b.addElem(c.list,d);controller.refresh({listData:e}),console.log("search done")},d.init=function(){var a=_.cloneDeep(b.getData());controller.refresh(a)},d.load=function(){console.logBlack("init "+a),b.load(),controller.init()},d.refer=function(){var a=$("div.editable").html();b.refer(a),controller.refresh()},d.refresh=function(a){console.logBlack("refresh");var b=_.cloneDeep(a);c.list=b.listData,c.texts=b.textData},d},simpleWebDevTool.dao.mainDao={},function(){var a=simpleWebDevTool.dao.mainDao,b=simpleWebDevTool.util;a.load=function(){console.log("dao.mainDao.load"),Bacon.combineTemplate({list:Bacon.fromPromise($.ajax("jsonApi/path/2")),jsTree:Bacon.fromPromise($.ajax("jsonApi/jstree/1")),slickGrid:Bacon.fromPromise($.ajax("jsonApi/slickGrid/1")),select2:Bacon.fromPromise($.ajax("jsonApi/select2/1")),tinyMce:Bacon.fromPromise($.ajax("jsonApi/tinyMce/1"))}).onValue(controller.refreshBacon)},a.save=function(a){return console.log("dao.mainDao.save"),b.putAjaxAsync("jsonApi/path/2",a,controller.refresh)}}(jQuery);var InfoWindowStock=function(){this.stock=[]};InfoWindowStock.prototype={createKey:function(a){var b=a.k+":"+a.A;return b},put:function(a,b){var c=this.createKey(a);this.stock[c]=b},get:function(a){var b=this.createKey(a);return this.stock[b]}},simpleWebDevTool.service.mainService={},function(){var a=simpleWebDevTool.service.mainService,b=simpleWebDevTool.dao;a.add=function(a,b){return console.log("service.mainService.add"),_.map(a,function(a){return a+Number(b)})},a.search=function(a,b){return console.log("service.mainService.search"),_.filter(a,function(a){return-1!==String(a).indexOf(b)})},a.addElem=function(a,b){console.log("service.mainService.addElem");for(var c=0;c<Number(b);++c)a.push(Math.random());return a},a.load=function(){console.log("service.mainService.load"),b.mainDao.load()},a.refer=function(a){return console.log("service.mainService.refer"),a+" ほげほげほげ"}}(jQuery),simpleWebDevTool.cache.ajaxCache={},simpleWebDevTool.util.getAjaxAsync=function(a,b){console.log("getAjaxAsync url:"+a);var c=simpleWebDevTool.cache.ajaxCache;return c[a]||$.ajax({type:"GET",url:a,async:!0}).done(function(d){console.log("success"),console.log(d),c[a]=d,b&&b()}).fail(function(){console.error("error")}),c[a]},simpleWebDevTool.util.getAjaxIfExist=function(a){return console.log("getAjaxIfExist url:"+a),simpleWebDevTool.cache.ajaxCache[a]},simpleWebDevTool.util.putAjaxAsync=function(a,b,c){console.log("putAjaxAsync url:"+a);var d={};return $.ajax({type:"POST",url:a,async:!0,data:b}).done(function(a){console.log("success"),console.log(a),d=a,c()}).fail(function(){console.error(b)}),d},simpleWebDevTool.util.getAjaxSyncWithCache=function(a){var b=[];return b[a]||$.ajax({type:"GET",url:a,async:!1}).done(function(c){console.log("success"),console.log(c),b[a]=c}).fail(function(){console.error("error")}),b[a]},simpleWebDevTool.cache.tmplCache={},simpleWebDevTool.util.render=function(a){var b=simpleWebDevTool.cache.tmplCache;if(!b[a]){var c="views/"+a+".html";$.ajax({url:c,method:"GET",async:!1,dataType:"html",success:function(c){b[a]=c}})}return b[a]},simpleWebDevTool.util.dummyWait=function(a){for(var b=(new Date).getTime(),c=(new Date).getTime();b+a>c;)c=(new Date).getTime()},simpleWebDevTool.util.countStart=function(){simpleWebDevTool.util.startTime=(new Date).getTime(),console.info("count start")},simpleWebDevTool.util.timeShow=function(){var a=(new Date).getTime();console.info(a-simpleWebDevTool.util.startTime+" ms")};